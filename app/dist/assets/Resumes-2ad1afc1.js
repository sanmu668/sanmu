import{d as T,r as d,o as N,b as r,C as j,e as $,B as I,h as t,g as n,i as b,S as M,k as P,ac as F,D as K,f as O,j as h,t as q,E as c,F as A}from"./index-a7f98987.js";import{a as m}from"./axios-3a665b0f.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";const G={class:"resumes-management"},H={class:"card-header"},J={class:"pagination-container"},W=T({__name:"Resumes",setup(X){m.defaults.baseURL="http://localhost:8080";const y=d([]),f=d(!1),u=d(1),_=d(10),C=d(0),g=d(""),p=async()=>{f.value=!0;try{const a=await m.get("/api/admin/resumes",{params:{page:u.value,size:_.value,query:g.value||void 0}});y.value=a.data.content,C.value=a.data.totalElements||a.data.content.length}catch{c.error("获取简历列表失败")}finally{f.value=!1}},k=()=>{u.value=1,p()},z=a=>{const e=`${m.defaults.baseURL}/api/admin/resumes/pdf/${a.id}`;try{const s=window.screen.width/2-425,v=window.screen.height/2-600/2;window.open(e,"_blank",`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no, width=850, height=600, top=${v}, left=${s}`)}catch{c.error("打开PDF失败")}},B=async a=>{try{const e=await m.get(`/api/admin/resumes/${a.id}/download`,{responseType:"blob"});if(!(e.data instanceof Blob))throw new Error("Invalid response format");const i=window.URL.createObjectURL(new Blob([e.data])),l=document.createElement("a");l.href=i,l.setAttribute("download",`${a.title||"resume"}.pdf`),document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(i),c.success("下载成功")}catch(e){console.error("Download error:",e),c.error(e instanceof Error?e.message:"下载失败，请稍后重试")}},R=a=>{A.confirm("确定要删除该简历吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await m.delete(`/api/admin/resumes/${a.id}`),c.success("删除成功"),p()}catch{c.error("删除失败")}}).catch(()=>{})},U=a=>{_.value=a,p()},D=a=>{u.value=a,p()};return N(()=>{p()}),(a,e)=>{const i=r("el-icon"),l=r("el-input"),s=r("el-table-column"),v=r("el-tag"),w=r("el-button"),E=r("el-table"),S=r("el-pagination"),V=r("el-card"),L=j("loading");return $(),I("div",G,[t(V,{class:"box-card"},{header:n(()=>[b("div",H,[e[3]||(e[3]=b("span",null,"简历管理",-1)),t(l,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=o=>g.value=o),placeholder:"搜索简历...",style:{width:"200px"},clearable:"",onClear:k,onKeyup:M(k,["enter"])},{prefix:n(()=>[t(i,null,{default:n(()=>[t(P(F))]),_:1})]),_:1},8,["modelValue"])])]),default:n(()=>[K(($(),O(E,{data:y.value,style:{width:"100%"}},{default:n(()=>[t(s,{prop:"id",label:"ID",width:"80"}),t(s,{prop:"userName",label:"用户名",width:"120"}),t(s,{prop:"title",label:"简历标题",width:"200"}),t(s,{prop:"education",label:"学历",width:"100"}),t(s,{prop:"experience",label:"工作经验",width:"100"}),t(s,{prop:"status",label:"状态",width:"100"},{default:n(({row:o})=>[t(v,{type:o.status==="active"?"success":"info"},{default:n(()=>[h(q(o.status==="active"?"已发布":"草稿"),1)]),_:2},1032,["type"])]),_:1}),t(s,{prop:"updateTime",label:"更新时间",width:"180"}),t(s,{label:"操作",fixed:"right",width:"200"},{default:n(({row:o})=>[t(w,{link:"",type:"primary",onClick:x=>z(o)},{default:n(()=>e[4]||(e[4]=[h("查看")])),_:2},1032,["onClick"]),t(w,{link:"",type:"primary",onClick:x=>B(o)},{default:n(()=>e[5]||(e[5]=[h("下载")])),_:2},1032,["onClick"]),t(w,{link:"",type:"danger",onClick:x=>R(o)},{default:n(()=>e[6]||(e[6]=[h("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,f.value]]),b("div",J,[t(S,{"current-page":u.value,"onUpdate:currentPage":e[1]||(e[1]=o=>u.value=o),"page-size":_.value,"onUpdate:pageSize":e[2]||(e[2]=o=>_.value=o),"page-sizes":[10,20,50,100],total:C.value,layout:"total, sizes, prev, pager, next",onSizeChange:U,onCurrentChange:D},null,8,["current-page","page-size","total"])])]),_:1})])}}});const te=Q(W,[["__scopeId","data-v-b41ad455"]]);export{te as default};
