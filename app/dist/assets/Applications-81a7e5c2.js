import{d as R,r as u,o as q,b as n,C as G,e as w,B as S,h as a,g as l,i as g,S as H,k as W,ac as X,D as Y,f as Z,j as v,t as ee,I as ae,J as te,E as b}from"./index-a7f98987.js";import{a as z}from"./axios-3a665b0f.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";const oe={class:"applications-management"},ne={class:"card-header"},se={class:"pagination-container"},ue={class:"dialog-footer"},re=R({__name:"Applications",setup(ie){const A=[{label:"待处理",value:"待处理"},{label:"简历筛选",value:"简历筛选"},{label:"面试中",value:"面试中"},{label:"已录用",value:"已录用"},{label:"已拒绝",value:"已拒绝"}],i=u([]),y=u(!1),d=u(1),_=u(10),p=u(0),h=u(""),c=u(!1),s=u({status:"",remark:""}),k=u(null),U=o=>({待处理:"info",简历筛选:"warning",面试中:"primary",已录用:"success",已拒绝:"danger"})[o]||"info",m=async()=>{var o;y.value=!0;try{const e=await z.get("http://localhost:8080/api/admin/applications",{params:{page:d.value,size:_.value,search:h.value}});console.log("API Response:",e.data),Array.isArray(e.data)?(i.value=e.data,p.value=e.data.length):typeof e.data=="object"&&e.data!==null?(i.value=[e.data],p.value=1):(o=e.data)!=null&&o.content?(i.value=e.data.content,p.value=e.data.totalElements):(i.value=[],p.value=0,console.warn("Unexpected API response format:",e.data))}catch(e){console.error("Error fetching applications:",e),b.error(`获取投递列表失败: ${(e==null?void 0:e.message)||"未知错误"}`),i.value=[],p.value=0}finally{y.value=!1}},C=()=>{d.value=1,m()},D=o=>{b.info("查看详情功能开发中")},E=o=>{k.value=o,s.value.status=o.status,s.value.remark="",c.value=!0},B=async()=>{if(k.value)try{await z.put(`http://localhost:8080/api/admin/applications/${k.value.id}/status`,{status:s.value.status,remark:s.value.remark}),b.success("状态更新成功"),c.value=!1,m()}catch(o){b.error("状态更新失败"),console.error("Error updating application status:",o)}},I=o=>{_.value=o,m()},N=o=>{d.value=o,m()};return q(()=>{m()}),(o,e)=>{const $=n("el-icon"),V=n("el-input"),r=n("el-table-column"),M=n("el-tag"),f=n("el-button"),P=n("el-table"),T=n("el-pagination"),j=n("el-card"),F=n("el-option"),K=n("el-select"),x=n("el-form-item"),J=n("el-form"),L=n("el-dialog"),O=G("loading");return w(),S("div",oe,[a(j,{class:"box-card"},{header:l(()=>[g("div",ne,[e[7]||(e[7]=g("span",null,"投递管理",-1)),a(V,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=t=>h.value=t),placeholder:"搜索投递记录...",style:{width:"200px"},clearable:"",onClear:C,onKeyup:H(C,["enter"])},{prefix:l(()=>[a($,null,{default:l(()=>[a(W(X))]),_:1})]),_:1},8,["modelValue"])])]),default:l(()=>[Y((w(),Z(P,{data:i.value,style:{width:"100%"}},{default:l(()=>[a(r,{prop:"id",label:"ID",width:"80"}),a(r,{prop:"jobName",label:"职位名称",width:"200"}),a(r,{prop:"company",label:"公司",width:"150"}),a(r,{prop:"userName",label:"申请人",width:"120"}),a(r,{prop:"status",label:"状态",width:"100"},{default:l(({row:t})=>[a(M,{type:U(t.status)},{default:l(()=>[v(ee(t.status),1)]),_:2},1032,["type"])]),_:1}),a(r,{prop:"submittedTime",label:"投递时间",width:"180"}),a(r,{prop:"updatedTime",label:"更新时间",width:"180"}),a(r,{label:"操作",fixed:"right",width:"200"},{default:l(({row:t})=>[a(f,{link:"",type:"primary",onClick:Q=>D(t)},{default:l(()=>e[8]||(e[8]=[v("查看")])),_:2},1032,["onClick"]),a(f,{link:"",type:"primary",onClick:Q=>E(t)},{default:l(()=>e[9]||(e[9]=[v("更新状态")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,y.value]]),g("div",se,[a(T,{"current-page":d.value,"onUpdate:currentPage":e[1]||(e[1]=t=>d.value=t),"page-size":_.value,"onUpdate:pageSize":e[2]||(e[2]=t=>_.value=t),"page-sizes":[10,20,50,100],total:p.value,layout:"total, sizes, prev, pager, next",onSizeChange:I,onCurrentChange:N},null,8,["current-page","page-size","total"])])]),_:1}),a(L,{modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=t=>c.value=t),title:"更新申请状态",width:"30%"},{footer:l(()=>[g("span",ue,[a(f,{onClick:e[5]||(e[5]=t=>c.value=!1)},{default:l(()=>e[10]||(e[10]=[v("取消")])),_:1}),a(f,{type:"primary",onClick:B},{default:l(()=>e[11]||(e[11]=[v(" 确认 ")])),_:1})])]),default:l(()=>[a(J,{model:s.value,"label-width":"80px"},{default:l(()=>[a(x,{label:"状态"},{default:l(()=>[a(K,{modelValue:s.value.status,"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.status=t),placeholder:"请选择状态"},{default:l(()=>[(w(),S(ae,null,te(A,t=>a(F,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(x,{label:"备注"},{default:l(()=>[a(V,{modelValue:s.value.remark,"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.remark=t),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const me=le(re,[["__scopeId","data-v-1707c33b"]]);export{me as default};
